<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Widget Preview</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .preview-content {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2d3748;
            margin-bottom: 20px;
        }
        
        .demo-content {
            line-height: 1.6;
            color: #4a5568;
            margin-bottom: 30px;
        }
        
        .widget-info {
            background: #f7fafc;
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #4299e1;
            margin-top: 30px;
        }
        
        .widget-info h3 {
            color: #2b6cb0;
            margin-bottom: 10px;
        }
        
        .widget-info p {
            color: #4a5568;
            margin: 0;
        }
    </style>
</head>
<body>
    <div class="preview-content">
        <h1>üéØ Widget Preview Page</h1>
        
        <div class="demo-content">
            <p>This is a demo page to show how the widget appears on a real website.</p>
            <p>The chat widget should appear in the corner of this page based on your configuration.</p>
            <p>Try different settings in the control panel and see how they affect the widget's appearance and behavior.</p>
            
            <h2>Sample Content</h2>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
            
            <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        </div>
        
        <div class="widget-info">
            <h3>üì± Widget Information</h3>
            <p id="widgetInfo">Loading widget configuration...</p>
        </div>
    </div>

    <script>
        // Get siteId from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const siteId = urlParams.get('siteId');
        
        if (siteId) {
            // Update widget info immediately
            document.getElementById('widgetInfo').innerHTML = `
                <strong>Site ID:</strong> ${siteId}<br>
                <strong>Widget Status:</strong> Loading...<br>
                <strong>Last Updated:</strong> ${new Date().toLocaleTimeString()}
            `;
            
            // Load the widget script
            const script = document.createElement('script');
            script.src = `/chat-widget-nuclear.js`;
            script.onload = function() {
                // Initialize widget with siteId
                if (window.ChatWidget && window.ChatWidget.setup) {
                    window.ChatWidget.setup({ siteId: siteId });
                    
                    setTimeout(() => {
                        document.getElementById('widgetInfo').innerHTML = `
                            <strong>Site ID:</strong> ${siteId}<br>
                            <strong>Widget Status:</strong> ‚úÖ Loaded & Active<br>
                            <strong>Last Updated:</strong> ${new Date().toLocaleTimeString()}
                        `;
                    }, 1000);
                } else {
                    document.getElementById('widgetInfo').innerHTML = `
                        <strong>Error:</strong> ‚ùå ChatWidget.setup not found<br>
                        <strong>Site ID:</strong> ${siteId}
                    `;
                }
            };
            script.onerror = function() {
                document.getElementById('widgetInfo').innerHTML = `
                    <strong>Error:</strong> ‚ùå Failed to load widget script<br>
                    <strong>Site ID:</strong> ${siteId}
                `;
            };
            document.head.appendChild(script);
        } else {
            document.getElementById('widgetInfo').innerHTML = `
                <strong>Error:</strong> ‚ùå No siteId provided in URL parameters
            `;
        }
    </script>
</body>
</html>
